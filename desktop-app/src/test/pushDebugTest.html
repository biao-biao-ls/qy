<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>推送调试工具测试</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .button:hover {
            background: #45a049;
        }
        .button.secondary {
            background: #2196F3;
        }
        .button.secondary:hover {
            background: #1976D2;
        }
        .button.warning {
            background: #FF9800;
        }
        .button.warning:hover {
            background: #F57C00;
        }
        .info {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 15px 0;
        }
        .code {
            background: #f4f4f4;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🎯 推送调试工具测试页面</h1>
        
        <div class="info">
            <h3>📖 使用说明</h3>
            <p>1. 按 <strong>F12</strong> 打开开发者工具</p>
            <p>2. 切换到 <strong>Console</strong> 面板</p>
            <p>3. 点击下面的按钮或直接在Console中输入命令</p>
        </div>

        <h3>🔧 快速操作</h3>
        <button class="button" onclick="testShowStatus()">📊 显示推送状态</button>
        <button class="button secondary" onclick="testShowStats()">📈 显示详细统计</button>
        <button class="button warning" onclick="testRestartService()">🔄 重启推送服务</button>
        <button class="button" onclick="testClearNotifications()">🧹 清除通知</button>
        <button class="button secondary" onclick="testShowHelp()">📖 显示帮助</button>

        <h3>💻 Console命令</h3>
        <div class="code">
            // 基础命令<br>
            showPushStatus()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// 显示推送状态<br>
            showPushStats()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// 显示详细统计<br>
            <br>
            // 完整命令<br>
            pushDebug.showStatus()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// 显示推送状态<br>
            pushDebug.showDetailedStats()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// 显示详细统计<br>
            pushDebug.restartService()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// 重启推送服务<br>
            pushDebug.clearNotifications()&nbsp;&nbsp;&nbsp;&nbsp;// 清除所有通知<br>
            pushDebug.showHelp()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// 显示帮助信息<br>
        </div>

        <h3>⌨️ 快捷键</h3>
        <div class="code">
            Ctrl + Shift + P&nbsp;&nbsp;&nbsp;&nbsp;// 显示推送状态<br>
            Ctrl + Shift + D&nbsp;&nbsp;&nbsp;&nbsp;// 显示详细统计<br>
            Ctrl + Shift + H&nbsp;&nbsp;&nbsp;&nbsp;// 显示帮助信息<br>
        </div>

        <h3>🔍 调试信息</h3>
        <div id="debugInfo">
            <p>推送调试工具状态: <span id="toolStatus">检查中...</span></p>
            <p>全局对象检查: <span id="globalCheck">检查中...</span></p>
        </div>

        <h3>📝 日志输出</h3>
        <p>所有调试信息将显示在开发者工具的Console面板中，包括：</p>
        <ul>
            <li>🔗 连接状态变化</li>
            <li>💓 心跳消息</li>
            <li>📨 消息接收和发送</li>
            <li>🔄 重连尝试</li>
            <li>❌ 错误信息</li>
        </ul>
    </div>

    <script>
        // 测试函数
        function testShowStatus() {
            console.log('🧪 [测试] 调用 showPushStatus()');
            if (typeof showPushStatus === 'function') {
                showPushStatus();
            } else {
                console.error('❌ showPushStatus 函数不存在');
            }
        }

        function testShowStats() {
            console.log('🧪 [测试] 调用 showPushStats()');
            if (typeof showPushStats === 'function') {
                showPushStats();
            } else {
                console.error('❌ showPushStats 函数不存在');
            }
        }

        function testRestartService() {
            console.log('🧪 [测试] 调用 pushDebug.restartService()');
            if (window.pushDebug && typeof window.pushDebug.restartService === 'function') {
                window.pushDebug.restartService();
            } else {
                console.error('❌ pushDebug.restartService 函数不存在');
            }
        }

        function testClearNotifications() {
            console.log('🧪 [测试] 调用 pushDebug.clearNotifications()');
            if (window.pushDebug && typeof window.pushDebug.clearNotifications === 'function') {
                window.pushDebug.clearNotifications();
            } else {
                console.error('❌ pushDebug.clearNotifications 函数不存在');
            }
        }

        function testShowHelp() {
            console.log('🧪 [测试] 调用 pushDebug.showHelp()');
            if (window.pushDebug && typeof window.pushDebug.showHelp === 'function') {
                window.pushDebug.showHelp();
            } else {
                console.error('❌ pushDebug.showHelp 函数不存在');
            }
        }

        // 检查推送调试工具状态
        function checkDebugToolStatus() {
            const toolStatusEl = document.getElementById('toolStatus');
            const globalCheckEl = document.getElementById('globalCheck');

            // 检查推送调试工具是否加载
            setTimeout(() => {
                if (window.pushDebug) {
                    toolStatusEl.textContent = '✅ 已加载';
                    toolStatusEl.style.color = 'green';
                } else {
                    toolStatusEl.textContent = '❌ 未加载';
                    toolStatusEl.style.color = 'red';
                }

                // 检查全局函数
                const globalFunctions = ['showPushStatus', 'showPushStats'];
                const availableFunctions = globalFunctions.filter(fn => typeof window[fn] === 'function');
                
                if (availableFunctions.length === globalFunctions.length) {
                    globalCheckEl.textContent = `✅ 全部可用 (${availableFunctions.length}/${globalFunctions.length})`;
                    globalCheckEl.style.color = 'green';
                } else {
                    globalCheckEl.textContent = `⚠️ 部分可用 (${availableFunctions.length}/${globalFunctions.length})`;
                    globalCheckEl.style.color = 'orange';
                }
            }, 3000);
        }

        // 页面加载完成后检查状态
        document.addEventListener('DOMContentLoaded', () => {
            console.log('🎯 [测试页面] 推送调试工具测试页面已加载');
            console.log('💡 [提示] 请打开开发者工具Console面板查看调试信息');
            
            checkDebugToolStatus();
        });

        // 添加键盘快捷键测试
        document.addEventListener('keydown', (event) => {
            if (event.ctrlKey && event.shiftKey) {
                switch (event.key) {
                    case 'P':
                        event.preventDefault();
                        console.log('⌨️ [快捷键] Ctrl+Shift+P 被按下');
                        testShowStatus();
                        break;
                    case 'D':
                        event.preventDefault();
                        console.log('⌨️ [快捷键] Ctrl+Shift+D 被按下');
                        testShowStats();
                        break;
                    case 'H':
                        event.preventDefault();
                        console.log('⌨️ [快捷键] Ctrl+Shift+H 被按下');
                        testShowHelp();
                        break;
                }
            }
        });
    </script>
</body>
</html>